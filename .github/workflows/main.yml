name: Copa del Rey 2026 Bot

on:
  schedule:
    # Se ejecuta a las 08:00 UTC (09:00 AM hora peninsular espaÃ±ola)
    # Los dÃ­as 6 (SÃ¡bado), 0 (Domingo) y 1 (Lunes)
    - cron: '0 8 * * 6,0,1'
  workflow_dispatch:

jobs:
  ejecutar-bot:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:
      - name: ğŸ“¥ Clonar el repositorio
        uses: actions/checkout@v4

      - name: ğŸ Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ğŸ“¦ Instalar librerÃ­as
        run: |
          python -m pip install --upgrade pip
          pip install requests pandas bs4 google-generativeai markdown

      - name: ğŸš€ Ejecutar el Controlador (check_status.py)
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          GMAIL_USER: ${{ secrets.GMAIL_USER }}
          GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
          URL_SUSCRIPTORES: ${{ secrets.URL_SUSCRIPTORES }}
        run: python check_status.py

      - name: ğŸ’¾ Guardar Base de Datos y Log en GitHub
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ¤– Bot: Actualizando base de datos y log de la Copa"
          file_pattern: data/*
